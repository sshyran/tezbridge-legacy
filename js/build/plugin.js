(function(){function b(d,e,g){function a(j,i){if(!e[j]){if(!d[j]){var k="function"==typeof require&&require;if(!i&&k)return k(j,!0);if(h)return h(j,!0);var c=new Error("Cannot find module '"+j+"'");throw c.code="MODULE_NOT_FOUND",c}var l=e[j]={exports:{}};d[j][0].call(l.exports,function(b){var c=d[j][1][b];return a(c||b)},l,l.exports,b,d,e,g)}return e[j].exports}for(var h="function"==typeof require&&require,c=0;c<g.length;c++)a(g[c]);return a}return b})()({1:[function(){((a)=>{const b=a.TZClient,c=(b)=>JSON.parse(a.localStorage.getItem(b)),d=(b)=>a.localStorage.removeItem(b),e=new Worker("js/build/tzclient.js"),f=(()=>{let a=1;const b={},c={};return e.onmessage=(a)=>{a.data.tezbridge_workerid&&(a.data.error?c[a.data.tezbridge_workerid]&&c[a.data.tezbridge_workerid](a.data.error):b[a.data.tezbridge_workerid]&&b[a.data.tezbridge_workerid](a.data.result),delete b[a.data.tezbridge_workerid],delete c[a.data.tezbridge_workerid])},(c,d)=>{const f=a++;return e.postMessage({tezbridge_workerid:f,method:c,params:d}),new Promise((a,c)=>{b[f]=a,c[f]=c})}})(),g={public_key_hash:{mute:!0,confirm(){return`get public key hash`},handler(){return f("public_key_hash")}},balance:{mute:!0,confirm(){return`get balance`},handler(a){return f("balance",a.data.contract).then((a)=>b.tz2r(a))}},block_head:{mute:!0,confirm(){return`get block head of node`},handler(){return f("head")}},contract:{mute:!0,confirm(a){return`get info for contract:${a.data.contract}`},handler(a){return f("contract",a.data.contract)}},transfer:{confirm(a){return`transfer ${a.data.amount}tz to ${a.data.destination} with parameter
${a.data.parameters&&JSON.stringify(a.data.parameters)||"Unit"}`},handler(a){return f("transfer",{amount:a.data.amount,source:a.data.source,destination:a.data.destination,parameters:a.data.parameters})}},originate:{confirm(a){return`originate contract for ${a.data.balance}tz
with code:${!!a.data.script}`},handler(a){return f("originate",{source:a.data.source,balance:a.data.balance,spendable:!!a.data.spendable,delegatable:!!a.data.delegatable,script:a.data.script,delegate:a.data.delegate})}},operations:{confirm(a){return`run operations list below:
${a.data.operations.map((a)=>a.method+(a.destination?`(${a.destination})`:"")+" with "+(a.amount||a.balance)+"tz").join("\n")}`},handler(a){const b=a.data.operations.filter((a)=>"transfer"===a.method||"originate"===a.method);return f("makeOperations",[b,0,a.data.source&&{source:a.data.source}])}}},h=(b)=>{if(b.data.tezbridge){const e=c("*").host;e&&f("setHost",e),f("public_key_hash").then((e)=>{if(!e){const e=c("__");if(d("__"),!e)b.source.postMessage({tezbridge:b.data.tezbridge,error:"no account found"},"*"),alert("CurrentHost:["+a.location.host+"]\nAccount is inaccessible\nPlease get your access code"),a.open("https://tezbridge.github.io/");else{const a=prompt("Input the access code");f("importCipherData",[e,a]).then(()=>{if(c("*").timeout){const a=+new Date,b=setInterval(()=>{1800000<=new Date-a&&c()},5e3),c=()=>{f("cleanKey"),clearInterval(b)}}h(b)}).catch(()=>{b.source.postMessage({tezbridge:b.data.tezbridge,error:"Decryption failed"},"*")})}}else{if(!g[b.data.method])return;if((!g[b.data.method].mute||!c("*").mute)&&!confirm(`Allow ${b.origin} to \n${g[b.data.method].confirm(b)}`))return void b.source.postMessage({tezbridge:b.data.tezbridge,error:"unpass confirmation"},"*");const a=g[b.data.method].handler(b);a&&a.then((a)=>{const c={result:a};c.tezbridge=b.data.tezbridge,b.source.postMessage(c,"*")}).catch((a)=>{b.source.postMessage({tezbridge:b.data.tezbridge,error:a},"*")})}})}};(()=>{a.addEventListener("message",h)})()})(window)},{}]},{},[1]);